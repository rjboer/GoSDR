<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>GoSDR Settings</title>
  <link rel="stylesheet" href="/static/style.css">
  <link rel="stylesheet" href="/static/settings_tooltips.css">
</head>

<body>
  <main>

    <div class="settings-container">

      <!-- LEFT SIDE: SETTINGS FORM -->
      <div class="settings-form-wrapper">
        <form id="configForm">

          <section class="card">
            <div class="section-heading">
              <h1>GoSDR Settings</h1>
              <p>Configure RF, timing, and SDR backend parameters</p>
            </div>

            <div class="field-grid">
              <label class="field" for="sampleRateHz">
                <span>Sample rate (Hz)</span>
                <input id="sampleRateHz" name="sampleRateHz" type="number" required>
                <small>IQ sample rate in Hz. Higher rates provide wider bandwidth but increase CPU load.</small>
              </label>

              <label class="field" for="rxLoHz">
                <span>RX LO (Hz)</span>
                <input id="rxLoHz" name="rxLoHz" type="number" required>
                <small>Receiver local oscillator frequency.</small>
              </label>

              <label class="field" for="toneOffsetHz">
                <span>Tone offset (Hz)</span>
                <input id="toneOffsetHz" name="toneOffsetHz" type="number" required>
                <small>Offset of calibration tone.</small>
              </label>

              <label class="field" for="spacingWavelength">
                <span>Spacing (wavelengths)</span>
                <input id="spacingWavelength" name="spacingWavelength" type="number" required>
                <small>Distance between antenna elements in wavelengths.</small>
              </label>

              <label class="field" for="rxGain0">
                <span>RX gain ch0 (dB)</span>
                <input id="rxGain0" name="rxGain0" type="number">
                <small>Receive gain for channel 0.</small>
              </label>

              <label class="field" for="rxGain1">
                <span>RX gain ch1 (dB)</span>
                <input id="rxGain1" name="rxGain1" type="number">
                <small>Receive gain for channel 1.</small>
              </label>

              <label class="field" for="txGain">
                <span>TX gain (dB)</span>
                <input id="txGain" name="txGain" type="number">
                <small>Transmit gain for calibration tone.</small>
              </label>
            </div>
          </section>

          <section class="card">
            <div class="section-heading">
              <h2>Timing & buffering</h2>
              <p>Capture windows and history retention</p>
            </div>
            <div class="field-grid">
              <label class="field" for="numSamples">
                <span>FFT size (samples)</span>
                <input id="numSamples" name="numSamples" type="number" required>
                <small>Must be a power of 2.</small>
              </label>

              <label class="field" for="bufferSize">
                <span>Buffer size</span>
                <input id="bufferSize" name="bufferSize" type="number" required>
                <small>Should be ‚â• FFT size.</small>
              </label>

              <label class="field" for="warmupBuffers">
                <span>Warmup buffers</span>
                <input id="warmupBuffers" name="warmupBuffers" type="number" required>
                <small>Buffers to discard at startup.</small>
              </label>

              <label class="field" for="historyLimit">
                <span>History limit</span>
                <input id="historyLimit" name="historyLimit" type="number" required>
                <small>Telemetry samples stored in memory.</small>
              </label>
            </div>
          </section>

          <section class="card">
            <div class="section-heading">
              <h2>Tracking</h2>
              <p>Monopulse scan and loop parameters</p>
            </div>

            <div class="field-grid">
              <label class="field" for="trackingLength">
                <span>Tracking iterations</span>
                <input id="trackingLength" name="trackingLength" type="number" required>
                <small>Legacy parameter.</small>
              </label>

              <label class="field" for="trackingMode">
                <span>Tracking mode</span>
                <select id="trackingMode" name="trackingMode">
                  <option value="single">Single</option>
                  <option value="multi">Multi</option>
                </select>
                <small>Choose single or multi target tracking.</small>
              </label>

              <label class="field" for="maxTracks">
                <span>Max tracks</span>
                <input id="maxTracks" name="maxTracks" type="number" required>
                <small>Maximum concurrent tracks.</small>
              </label>

              <label class="field" for="trackTimeoutMs">
                <span>Track timeout (ms)</span>
                <input id="trackTimeoutMs" name="trackTimeoutMs" type="number" required>
                <small>Timeout before a track is removed.</small>
              </label>

              <label class="field" for="snrThreshold">
                <span>SNR threshold (dB)</span>
                <input id="snrThreshold" name="snrThreshold" type="number" required>
                <small>Minimum signal-to-noise ratio.</small>
              </label>

              <label class="field" for="phaseStepDeg">
                <span>Phase step (deg)</span>
                <input id="phaseStepDeg" name="phaseStepDeg" type="number" required>
                <small>Monopulse refinement step.</small>
              </label>

              <label class="field" for="scanStepDeg">
                <span>Scan step (deg)</span>
                <input id="scanStepDeg" name="scanStepDeg" type="number" required>
                <small>Coarse scan angular step.</small>
              </label>

              <label class="field" for="phaseCalDeg">
                <span>Phase calibration (deg)</span>
                <input id="phaseCalDeg" name="phaseCalDeg" type="number" required>
                <small>Offset correction.</small>
              </label>

              <label class="field" for="phaseDeltaDeg">
                <span>Phase delta (deg)</span>
                <input id="phaseDeltaDeg" name="phaseDeltaDeg" type="number" required>
                <small>Initial phase delta estimate.</small>
              </label>
            </div>
          </section>

          <section class="card">
            <div class="section-heading">
              <h2>SDR backend</h2>
              <p>Radio selection and connection target</p>
            </div>

            <div class="field-grid">
              <label class="field" for="sdrBackend">
                <span>Backend</span>
                <select id="sdrBackend" name="sdrBackend">
                  <option value="mock">Mock</option>
                  <option value="pluto">Pluto / AD9361</option>
                </select>
                <small>Choose SDR engine.</small>
              </label>

              <label class="field" for="sdrUri">
                <span>Backend URI</span>
                <input id="sdrUri" name="sdrUri" type="text" placeholder="ip:192.168.2.1">
                <small>Connection URI for hardware SDR.</small>
              </label>

              <label class="field" for="mockPhaseDelta">
                <span>Mock phase delta (deg)</span>
                <input id="mockPhaseDelta" name="mockPhaseDelta" type="number">
                <small>Simulated phase delta for MockSDR.</small>
              </label>
            </div>
          </section>

          <section class="card" id="mockControlSection" style="display:none;">
            <div class="section-heading">
              <h2>MockSDR Live Control</h2>
            </div>

            <div class="field-grid">
              <label class="field" for="mockAngleSlider">
                <span>Simulated Angle (degrees)</span>
                <div class="slider-container">
                  <input id="mockAngleSlider" type="range" min="-90" max="90" step="0.5" value="0">
                  <output id="mockAngleValue">0.0¬∞</output>
                </div>
                <small>Drag to set simulated phase delta.</small>
              </label>
            </div>

            <div class="mock-status" id="mockStatus">
              <span class="status-indicator"></span>
              <span class="status-text">Ready</span>
            </div>
          </section>

          <section class="card">
            <div class="section-heading">
              <h2>Logging</h2>
            </div>

            <div class="field-grid">
              <label class="field" for="logLevel">
                <span>Log level</span>
                <select id="logLevel" name="logLevel">
                  <option value="error">Error</option>
                  <option value="warn">Warn</option>
                  <option value="info">Info</option>
                  <option value="debug">Debug</option>
                </select>
              </label>

              <label class="field" for="logFormat">
                <span>Log format</span>
                <select id="logFormat" name="logFormat">
                  <option value="text">Text</option>
                  <option value="json">JSON</option>
                </select>
              </label>

              <label class="field" for="debugMode">
                <span>Debug mode</span>
                <input id="debugMode" name="debugMode" type="checkbox">
                <small>Include DSP internals in telemetry.</small>
              </label>
            </div>
          </section>

          <div class="form-actions">
            <button type="submit">Save changes</button>
            <button type="button" id="resetBtn" class="ghost">Reset to defaults</button>
            <span id="status" class="status hidden"></span>
          </div>

        </form>
      </div>

      <!-- RIGHT SIDE: HELP SIDEBAR -->
      <aside class="help-sidebar">
        <div class="help-sidebar-header">
          <h3>üìñ Parameter Help</h3>
          <p>Click the ‚ÑπÔ∏è icons next to fields for detailed explanations</p>
        </div>

        <div id="helpContentContainer">
          <div class="help-empty">
            <div class="help-empty-icon">‚ÑπÔ∏è</div>
            <p>Select a parameter to view help</p>
          </div>
        </div>
      </aside>

    </div>

  </main>

  <script src="/static/settings_tooltips.js"></script>
  <script src="/static/settings.js"></script>

</body>

</html>