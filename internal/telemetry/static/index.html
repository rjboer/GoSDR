<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <title>GoSDR Telemetry</title>
  <link rel="stylesheet" href="/static/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <header class="page-header">
    <div>
      <h1>GoSDR Monopulse Tracker</h1>
      <p>Live steering angle and peak telemetry</p>
    </div>
    <nav class="top-nav" aria-label="Primary">
      <a class="active" href="/">Telemetry</a>
      <a href="/settings">Settings</a>
    </nav>
  </header>
  <main>
    <div class="tab-header" role="tablist" aria-label="Telemetry views">
      <button class="tab-button active" role="tab" aria-selected="true" aria-controls="telemetry" data-tab="telemetry">Telemetry</button>
      <button class="tab-button" role="tab" aria-selected="false" aria-controls="trace" data-tab="trace">Trace</button>
      <button class="tab-button" role="tab" aria-selected="false" aria-controls="debug" data-tab="debug">Debug</button>
      <button class="tab-button" role="tab" aria-selected="false" aria-controls="settings" data-tab="settings">Settings</button>
    </div>
    <section id="telemetry" class="tab-panel active" role="tabpanel" aria-label="Telemetry charts">
      <div class="chart-grid">
        <div class="chart-panel radar-panel">
          <h2>Radar Display</h2>
          <canvas id="radarCanvas" width="400" height="250" aria-label="Radar display"></canvas>
          <div class="radar-info">
            <span id="radarAngle">Angle: --</span>
            <div class="metric-strip">
              <div class="metric-card">
                <p class="muted">SNR</p>
                <div id="snrValue" class="metric-value">-- dB</div>
              </div>
              <div class="metric-card">
                <p class="muted">Confidence</p>
                <div id="confidenceValue" class="metric-value">--%</div>
              </div>
              <div class="metric-card">
                <p class="muted">Lock</p>
                <div id="lockBadge" class="lock-badge">searching</div>
              </div>
            </div>
          </div>
        </div>
        <div class="chart-panel">
          <h2>Steering Angle</h2>
          <canvas id="angleChart" aria-label="Angle chart"></canvas>
        </div>
        <div class="chart-panel">
          <h2>Peak Level</h2>
          <canvas id="peakChart" aria-label="Peak chart"></canvas>
        </div>
        <div class="chart-panel">
          <h2>SNR</h2>
          <canvas id="snrChart" aria-label="SNR chart"></canvas>
        </div>
        <div class="chart-panel">
          <h2>Tracking Confidence</h2>
          <canvas id="confidenceChart" aria-label="Confidence chart"></canvas>
        </div>
      </div>
      <div class="info-grid">
        <div class="chart-panel summary-panel">
          <h2>Settings Summary</h2>
          <div class="summary-grid">
            <div class="summary-card">
              <p class="muted">SDR backend</p>
              <div id="summaryBackend" class="metric-value">--</div>
            </div>
            <div class="summary-card">
              <p class="muted">RX LO</p>
              <div id="summaryRxLo" class="metric-value">--</div>
            </div>
            <div class="summary-card">
              <p class="muted">Tone offset</p>
              <div id="summaryToneOffset" class="metric-value">--</div>
            </div>
            <div class="summary-card">
              <p class="muted">Sample rate</p>
              <div id="summarySampleRate" class="metric-value">--</div>
            </div>
            <div class="summary-card">
              <p class="muted">FFT size</p>
              <div id="summaryFftSize" class="metric-value">--</div>
            </div>
          </div>
        </div>
        <div class="chart-panel stats-panel">
          <h2>Live Statistics</h2>
          <div class="stats-grid">
            <div class="stat-group">
              <div class="stat-heading">Angle (deg)</div>
              <div class="stat-cards">
                <div class="summary-card">
                  <p class="muted">Avg</p>
                  <div id="angleAvg" class="metric-value">--</div>
                </div>
                <div class="summary-card">
                  <p class="muted">Std dev</p>
                  <div id="angleStd" class="metric-value">--</div>
                </div>
                <div class="summary-card">
                  <p class="muted">Min</p>
                  <div id="angleMin" class="metric-value">--</div>
                </div>
                <div class="summary-card">
                  <p class="muted">Max</p>
                  <div id="angleMax" class="metric-value">--</div>
                </div>
              </div>
            </div>
            <div class="stat-group">
              <div class="stat-heading">Peak (dBFS)</div>
              <div class="stat-cards">
                <div class="summary-card">
                  <p class="muted">Avg</p>
                  <div id="peakAvg" class="metric-value">--</div>
                </div>
                <div class="summary-card">
                  <p class="muted">Std dev</p>
                  <div id="peakStd" class="metric-value">--</div>
                </div>
                <div class="summary-card">
                  <p class="muted">Min</p>
                  <div id="peakMin" class="metric-value">--</div>
                </div>
                <div class="summary-card">
                  <p class="muted">Max</p>
                  <div id="peakMax" class="metric-value">--</div>
                </div>
              </div>
            </div>
          </div>
          <div class="update-rate">
            <p class="muted">Update rate</p>
            <div id="updateRate" class="metric-value">--</div>
          </div>
        </div>
      </div>
    </section>
    <section id="trace" class="tab-panel" role="tabpanel" aria-label="Trace view">
      <div class="chart-panel trace-panel">
        <div class="trace-header">
          <div>
            <h2>Trace</h2>
            <p class="muted">Live telemetry samples with export options</p>
          </div>
          <div class="trace-meta">
            <span id="traceCount" class="metric-value">0 / 500</span>
            <span id="traceStatus" class="trace-status-badge">live</span>
          </div>
        </div>
        <div class="trace-controls" role="group" aria-label="Trace controls">
          <div class="trace-actions">
            <button id="tracePauseBtn" class="secondary-btn" type="button">Pause</button>
            <button id="traceClearBtn" class="secondary-btn" type="button">Clear history</button>
          </div>
          <div class="trace-export" aria-label="Trace export controls">
            <label for="traceExportFormat" class="muted">Export as</label>
            <select id="traceExportFormat" aria-label="Trace export format">
              <option value="csv">CSV</option>
              <option value="json">JSON</option>
            </select>
            <button id="traceCopyBtn" class="secondary-btn" type="button">Copy</button>
            <button id="traceDownloadBtn" class="primary-btn" type="button">Download</button>
          </div>
        </div>
        <div class="trace-table" aria-live="polite">
          <div class="trace-table-header">
            <div>Timestamp</div>
            <div>Angle (deg)</div>
            <div>Peak (dBFS)</div>
          </div>
          <div class="trace-table-body" id="traceViewport">
            <div id="traceVirtualList" class="trace-virtual-list" role="rowgroup"></div>
          </div>
        </div>
      </div>
    </section>
    <section id="debug" class="tab-panel" role="tabpanel" aria-label="Debug view">
      <div class="debug-panel" aria-live="polite">
        <div class="debug-header">
          <h2>Debug telemetry</h2>
          <p id="debugStatus" class="muted">Waiting for diagnosticsâ€¦</p>
        </div>
        <div class="debug-sections">
          <div class="debug-section">
            <div class="debug-section-header">
              <h3>System Status</h3>
              <span class="muted" id="debugLastUpdated">--</span>
            </div>
            <div class="debug-grid">
              <div class="debug-card">
                <h4>Uptime</h4>
                <div class="debug-value" id="diagUptime">--</div>
                <p class="muted">Started at <span id="diagStartTime">--</span></p>
              </div>
              <div class="debug-card">
                <h4>Samples</h4>
                <div class="debug-value" id="diagSamples">--</div>
                <p class="muted">Last sample <span id="diagLastSample">--</span></p>
              </div>
              <div class="debug-card">
                <h4>Update rate</h4>
                <div class="debug-value" id="diagUpdateRate">--</div>
                <p class="muted">avg samples/sec</p>
              </div>
            </div>
          </div>
          <div class="debug-section">
            <div class="debug-section-header">
              <h3>Performance</h3>
            </div>
            <div class="debug-grid">
              <div class="debug-card">
                <h4>CPU load</h4>
                <div class="debug-value" id="diagCpuLoad">--</div>
                <p class="muted">recent process usage</p>
              </div>
              <div class="debug-card">
                <h4>Memory</h4>
                <div class="debug-value" id="diagMemAlloc">--</div>
                <p class="muted">Total reserved <span id="diagMemSys">--</span></p>
              </div>
              <div class="debug-card">
                <h4>Goroutines</h4>
                <div class="debug-value" id="diagGoroutines">--</div>
                <p class="muted">Iteration <span id="diagIterationTime">--</span></p>
              </div>
            </div>
          </div>
          <div class="debug-section">
            <div class="debug-section-header">
              <h3>Signal Quality</h3>
            </div>
            <div class="debug-grid">
              <div class="debug-card">
                <h4>SNR</h4>
                <div class="debug-value" id="diagSNR">--</div>
                <p class="muted">Noise floor <span id="diagNoiseFloor">--</span></p>
              </div>
              <div class="debug-card">
                <h4>Confidence</h4>
                <div class="debug-value" id="diagConfidence">--</div>
                <p class="muted">Lock <span class="lock-badge" id="diagLockState">--</span></p>
              </div>
            </div>
          </div>
          <div class="debug-section">
            <div class="debug-section-header">
              <h3>Debug Info</h3>
            </div>
            <div class="debug-grid">
              <div class="debug-card">
                <h4>Phase delay</h4>
                <div class="debug-value" id="debugPhaseDelay">--</div>
                <p class="muted">Monopulse phase <span id="debugMonopulsePhase">--</span></p>
              </div>
              <div class="debug-card">
                <h4>Peak</h4>
                <div class="debug-value" id="debugPeakValue">--</div>
                <p class="muted">Bin <span id="debugPeakBin">--</span> in band <span id="debugPeakBand">--</span></p>
              </div>
            </div>
          </div>
          <div class="debug-section">
            <div class="debug-section-header">
              <h3>Event Log</h3>
              <span class="muted">Latest 100 events</span>
            </div>
            <div class="event-log">
              <div class="event-log-header">
                <span>Time</span>
                <span>Level</span>
                <span>Message</span>
              </div>
              <div class="event-log-body" id="eventLog"></div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <section id="settings" class="tab-panel" role="tabpanel" aria-label="Settings view">
      <div class="placeholder">
        <h2>Settings</h2>
        <p>Manage configuration from the <a href="/settings">settings page</a>.</p>
      </div>
    </section>
  </main>
  <script src="/static/app.js"></script>
</body>

</html>